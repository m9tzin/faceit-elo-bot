name: Dependency Update Check

on:
  schedule:
    - cron: '0 9 * * 1'
  workflow_dispatch:

jobs:
  check-updates:
    name: ðŸ” Check for Dependency Updates
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4
      
      - name: ðŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'
      
      - name: ðŸ“¦ Install current dependencies
        run: npm ci
      
      - name: ðŸ“Š Check for outdated packages
        run: |
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘    OUTDATED PACKAGES CHECK            â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          npm outdated || true
          echo ""
          echo "ðŸ’¡ To update packages:"
          echo "   - npm update          (safe updates)"
          echo "   - npm outdated        (check versions)"
          echo "   - npm install pkg@latest  (major updates)"
          echo ""
      
      - name: ðŸ”’ Security vulnerabilities check
        run: |
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘    SECURITY AUDIT                     â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          npm audit || true
          echo ""
          echo "ðŸ’¡ To fix vulnerabilities:"
          echo "   - npm audit fix       (automatic fixes)"
          echo "   - npm audit fix --force  (may break changes)"
          echo ""
      
      - name: ðŸ“ˆ Dependency information
        run: |
          echo ""
          echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
          echo "â•‘    DEPENDENCY INFORMATION             â•‘"
          echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "ðŸ“¦ Current dependencies:"
          npm list --depth=0
          echo ""
          echo "ðŸ“Š Dependency stats:"
          echo "  - Total packages: $(npm list --all 2>/dev/null | grep -c "â”œ\|â””" || echo "N/A")"
          echo "  - node_modules size: $(du -sh node_modules 2>/dev/null | cut -f1)"
          echo ""

